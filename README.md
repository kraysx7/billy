BILLY
====

## Общее описание

BILLY реализует основной функционал платёжного шлюза. Позволяет самостоятельно организовать приём и отправку денежных средств для своих интернет проектов, не прибегая к услугам платёжных агрегаторов.

Поддерживается скриптовое расширение функционала с помощью встроенного php интерпретатора.

## Минимальные требования к системе

- Any Unix system
- Erlang 19
- Mysql 5.3 или MariaDB 10.2

## Сборка, настройка, запуск

Получаем исходный код приложения и компилируем :

	$ git clone https://github.com/kraysx7/billy.git
	$ cd billy
	$ ./rebar3 compile

После успешной компиляции, можно запустить сервер в shell режиме с помощью команды ./rebar3 shell , или подготовить релиз для запуска :

	$ ./rebar3 release

Подготовленный релиз будет находится в папке *_build/default/rel/billy*  , который можно скопировать в любое место файловой системы на ваше усмотрение. Управление запуском и остановкой  осущевствляется с помощью исполняемого файла *bin/billy* . Данный файл является стандартным выполняемым файлом для релизов Erlang OTP.

Далее необходимо настроить само приложение и базу данных.

## Настройка приложения

Конфигурация приложения находится в файле *config/billy.config*.

Если вы запускаете приложение в *shell* режиме, каталог *config* должен находится в корневом каталоге с исходными кодами.

Если вы запускаете приложение в *production* режиме,  каталог *config* должен находится в корневом каталоге созданного релиза.

Для указания на какой сетевой адрес и порт принимать входящие запросы к API отредактируйте параметры :

- *listen_address*
- *listen_port*

Для настройки доступа к базе данных отредактируйте параметры :

- *mysql_host*
- *mysql_port*
- *mysql_username*
- *mysql_password*
- *mysql_database*

Для настройки системы отправки средств необходимо отредактировать блок

- *masspayments_config* (см. примеры)

## Настройка базы данных

Создаём базу

	mysql > CREATE DATABASE `billy` CHARACTER SET utf8 COLLATE utf8_general_ci;
	mysql > USE `billy`;

Создаём таблицы

	mysql (billy)> source %BILLY_DIR%/sql/billy_config.sql;
	mysql (billy)> source %BILLY_DIR%/sql/billy_masspayment_order.sql
	mysql (billy)> source %BILLY_DIR%/sql/billy_transaction.sql

Создаём хранимые процедуры

	mysql (billy)> source %BILLY_DIR%/sql/billy_procedures.sql

После успешного создания таблиц и хранимых процедур, необходимо добавить пользователей системы (мерчантов шлюза) , а также их конфигурации платёжных систем (интерфейс добавления магазинов и их настройки находится в процессе разработки).

## Описание принципов работы
in progress
## Описание API
in progress
## Подключение других платёжных систем
in progress
